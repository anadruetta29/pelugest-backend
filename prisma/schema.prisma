// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Role {
    id    String @id @default(uuid())
    name  String @unique
	users User[] 

  @@map("roles")
}

model RecordStatus {
	id    String @id @default(uuid())
	name  String @unique

	users    User[]
	clients  Client[]
	services Service[]
	products Product[]

	@@map("record_status")
}


model User {
    id               String @id @default(uuid())
    name             String
    surname         String
    email            String @unique
    password         String
    id_rol           String
    id_record_status String   

    role   Role         @relation(fields: [id_rol], references: [id])
    status RecordStatus @relation(fields: [id_record_status], references: [id])

    @@map("users")
}

model Client {
    id     String @id @default(uuid())
    name   String
    surname String
    mobilePhoneNumber String
    landlinePhoneNumber String
    id_record_status String 

    status RecordStatus @relation(fields: [id_record_status], references: [id])

    @@map("clients")
}

model ServiceProductRequirement {
	id     String @id @default(uuid())
	standardAmountMl Int 
	id_service String
	id_product String

	product Product @relation(fields: [id_product], references: [id])
	service Service @relation(fields: [id_service], references: [id])

	@@map("service_product_requirements")
}

model Service {
	id     String @id @default(uuid()) 
	name   String
	description String
	estimatedDurationMin Int
	basePrice Decimal
	id_record_status String

	status RecordStatus @relation(fields: [id_record_status], references: [id])
	requirements ServiceProductRequirement[]

	@@map("services")
}

model StockProduct {
	id     String @id @default(uuid()) 
	currentAmountMl Int
	minimumStockMl Int
  	id_product      String @unique

	product Product @relation(fields: [id_product], references: [id])

	@@map("stock_products")
}

model Product {
	id     String @id @default(uuid()) 
	name   String
	price Decimal
	id_record_status String

	status RecordStatus @relation(fields: [id_record_status], references: [id])
	stock  StockProduct?
 	requirements ServiceProductRequirement[]

	@@map("products")
}
